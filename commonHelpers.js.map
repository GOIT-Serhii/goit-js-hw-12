{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = \"44781960-4338c4c6360104e4623fadff2\";\n\n\n\naxios.defaults.baseURL = BASE_URL;\n\nfunction getPictures({q = \"\", page = 1, pageSize = 20, imageType = 'photo', orientation = 'horizontal', safeSearch = 'true' } = {}) {\n\n\nreturn axios\n        .get('', {\n                params: {\n                        key: API_KEY,\n                        q,\n                        page,\n                        per_page: pageSize,\n                        image_type: imageType,\n                        orientation,\n                        safesearch: safeSearch\n                }\n        })\n        .then(({ data }) => data);\n}\n\n\nexport { getPictures }\n","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nexport function createMarkup(hits, cardContainer) {\n    const markup = hits.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => {\n        return `\n            <li class=\"item\">\n                <a href=\"${largeImageURL}\">\n                    <img class=\"image\" src=\"${webformatURL}\" alt=\"${tags}\" width=\"360\">\n                </a>\n                <ul class=\"descr-list\">\n                    <li class=\"descr-item\">\n                        <h3 class=\"descr-title\">Likes</h3>\n                        <p class=\"descr-value\">${likes}</p>\n                    </li>\n                    <li class=\"descr-item\">\n                        <h3 class=\"descr-title\">Views</h3>\n                        <p class=\"descr-value\">${views}</p>\n                    </li>\n                    <li class=\"descr-item\">\n                        <h3 class=\"descr-title\">Comments</h3>\n                        <p class=\"descr-value\">${comments}</p>\n                    </li>\n                    <li class=\"descr-item\">\n                        <h3 class=\"descr-title\">Downloads</h3>\n                        <p class=\"descr-value\">${downloads}</p>\n                    </li>\n                </ul>\n            </li>\n        `;\n    }).join('');\n\n    cardContainer.insertAdjacentHTML('beforeend', markup);\n\n    const lightbox = new SimpleLightbox('.card-container a', {\n        captions: true,\n        captionsData: 'alt',\n        captionPosition: 'bottom',\n        captionDelay: 250,\n    });\n\n    lightbox.refresh();\n}\n\nexport function onFetchError() {\n    iziToast.error({\n        message: 'Sorry, there are no images matching your search query. Please try again!',\n    });\n}\n\nexport function onSearchError() {\n    iziToast.error({\n        message: 'You need to print something',\n    });\n}\n\nconst hiddenClass = 'is-hidden';\n\nfunction hide(button) {\n    button.classList.add(hiddenClass);\n}\n\nfunction show(button) {\n    button.classList.remove(hiddenClass);\n}\n\nfunction disable(button, spinner) {\n    button.disabled = true;\n    spinner.classList.remove(hiddenClass);\n}\n\nfunction enable(button, spinner) {\n    button.disabled = false;\n    spinner.classList.add(hiddenClass);\n}\n\nexport const buttonService = { show, disable, hide, enable };\n","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport { getPictures } from './js/pixabay-api.js';\nimport { createMarkup, onSearchError, onFetchError, buttonService } from './js/render-functions';\n\n\nconst formSearch = document.querySelector('.form-search');\nconst cardContainer = document.querySelector('.card-container');\nconst loadMoreBtn = document.querySelector('[data-action=\"load-more\"]');\nconst spinner = document.querySelector('.spinner');\n\nconst params = {\n    q: \"\",\n    page: 1,\n    pageSize: 15,\n    maxPage: 0,\n    imageType: 'photo',\n    orientation: 'horizontal',\n    safeSearch: 'true',\n};\nbuttonService.hide(loadMoreBtn);\n\nformSearch.addEventListener('submit', handlerSearch);\n\nasync function handlerSearch(event) {\n    event.preventDefault();\n\n    const form = event.currentTarget;\n\n    cardContainer.innerHTML = \"\";\n    params.page = 1;\n    params.q = form.elements.search.value.trim().toLowerCase();\n\n    if (!params.q) {\n        onSearchError();\n        form.reset();\n        return;\n    }\n\n    buttonService.show(loadMoreBtn);\n    buttonService.disable(loadMoreBtn, spinner);\n\n    try {\n        const { hits, totalHits } = await getPictures(params);\n        \n        if (hits.length === 0) {\n            onFetchError();\n            buttonService.hide(loadMoreBtn);\n            form.reset();\n            return;\n        }\n\n        params.maxPage = Math.ceil(totalHits / params.pageSize);\n        createMarkup(hits, cardContainer);  \n\n        if (hits.length > 0 && params.page < params.maxPage) {\n            buttonService.enable(loadMoreBtn, spinner);\n            loadMoreBtn.addEventListener('click', handlerLoadMore);\n        } else {\n            buttonService.hide(loadMoreBtn);\n        }\n\n    } catch (err) {\n        console.error('Error fetching pictures:', err);\n        onFetchError();\n    } finally {\n        form.reset();\n    }\n}\n\nasync function handlerLoadMore() {\n    params.page += 1;\n    buttonService.disable(loadMoreBtn, spinner);\n\n    try {\n        const { hits } = await getPictures(params);\n        createMarkup(hits, cardContainer);  \n        smoothScroll();\n    } catch (err) {\n        iziToast.error({\n            message: 'We\\'re sorry, but you\\'ve reached the end of search results.',\n        });\n    } finally {\n        buttonService.enable(loadMoreBtn, spinner);\n        \n        if (params.page === params.maxPage) {\n            buttonService.hide(loadMoreBtn);\n            loadMoreBtn.removeEventListener('click', handlerLoadMore);\n        }\n    }\n}\n\nfunction smoothScroll() {\n    const { height: cardHeight } = document.querySelector('.card-container li').getBoundingClientRect();\n    window.scrollBy({\n        top: cardHeight * 2,\n        behavior: 'smooth',\n    });\n}\n\n\n"],"names":["BASE_URL","API_KEY","axios","getPictures","q","page","pageSize","imageType","orientation","safeSearch","data","createMarkup","hits","cardContainer","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","SimpleLightbox","onFetchError","iziToast","onSearchError","hiddenClass","hide","button","show","disable","spinner","enable","buttonService","formSearch","loadMoreBtn","params","handlerSearch","event","form","totalHits","handlerLoadMore","err","smoothScroll","cardHeight"],"mappings":"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"}